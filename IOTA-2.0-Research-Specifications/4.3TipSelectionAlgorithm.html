<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="IOTA Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="IOTA Wiki Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="IOTA Wiki" href="/opensearch.xml">
<link rel="preconnect" href="${matomoUrl}">
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://matomo.antonionardella.it/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","6"]);var e=document,t=e.createElement("script"),p=e.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=a+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">4.3 Tip Selection Algorithm | IOTA Wiki</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wiki.iota.org/IOTA-2.0-Research-Specifications/4.3TipSelectionAlgorithm"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-IOTA-Research-Specifications-current"><meta data-react-helmet="true" property="og:title" content="4.3 Tip Selection Algorithm | IOTA Wiki"><meta data-react-helmet="true" name="description" content="The tip selection algorithm picks messages for approval by messages that join the network later. It allows the Tangle to grow in a stable and secure way, with quick approval and finality times."><meta data-react-helmet="true" property="og:description" content="The tip selection algorithm picks messages for approval by messages that join the network later. It allows the Tangle to grow in a stable and secure way, with quick approval and finality times."><meta data-react-helmet="true" name="keywords" content="Tips Pool,strong tips,weak tips,random,selection"><meta data-react-helmet="true" property="og:image" content="https://wiki.iota.org/img/research-specifications/parents.png"><meta data-react-helmet="true" name="twitter:image" content="https://wiki.iota.org/img/research-specifications/parents.png"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wiki.iota.org/IOTA-2.0-Research-Specifications/4.3TipSelectionAlgorithm"><link data-react-helmet="true" rel="alternate" href="https://wiki.iota.org/IOTA-2.0-Research-Specifications/4.3TipSelectionAlgorithm" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wiki.iota.org/IOTA-2.0-Research-Specifications/4.3TipSelectionAlgorithm" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.3b153719.css">
<link rel="preload" href="/assets/js/runtime~main.fb93c638.js" as="script">
<link rel="preload" href="/assets/js/main.bf5c9b22.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#da7ad7;color:#000000" role="banner"><div class="announcementBarPlaceholder_2m9F"></div><div class="announcementBarContent_3EUC">Would you like to stake your tokens? <a target="_blank" href="https://assembly.sc">Read more</a> about Assembly, the upcoming permissionless Smart Contract network.</div><button type="button" class="clean-btn close announcementBarClose_38nx" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_1VR7"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="IOTA Wiki Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo_dark.svg" alt="IOTA Wiki Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div></a><a class="navbar__item navbar__link" href="/learn/about-iota/an-introduction-to-iota"><div class="link"><div class="link__body"><div class="link__label">Learn</div></div></div></a><a class="navbar__item navbar__link" href="/participate/support-the-network/about-nodes"><div class="link"><div class="link__body"><div class="link__label">Participate</div></div></div></a><div class="dropdown dropdown--hoverable dropdown--mega"><a class="navbar__item navbar__link navbar__link--active"><div class="link"><div class="link__body"><div class="link__label">Build | Coordicide Specs</div></div></div></a><div class="dropdown__container"><div class="dropdown__menu"><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Getting Started</div></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Chrysalis (IOTA 1.5)</div></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Libraries</div></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Smart Contracts</div></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/build/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Getting Started</div><div class="link__sublabel">IOTA development basics</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/chrysalis-docs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Chrysalis Docs</div><div class="link__sublabel">Mainnet documentation</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/iota.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Client</div><div class="link__sublabel">Interact with the IOTA network</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/smart-contracts/overview"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Wasp Node</div><div class="link__sublabel">Smart contract node</div></div></div></a></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/bee/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Bee Node</div><div class="link__sublabel">IOTA node written in Rust</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/wallet.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Wallet</div><div class="link__sublabel">Build IOTA wallets</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Coordicide (IOTA 2.0)</div></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/hornet/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Hornet Node</div><div class="link__sublabel">IOTA node written in Go</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/stronghold.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Stronghold</div><div class="link__sublabel">Handle secrets securely</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a aria-current="page" class="dropdown__link dropdown__link--active" href="/IOTA-2.0-Research-Specifications/Preface"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Coordicide Specs</div><div class="link__sublabel">Decentralizing IOTA</div></div></div></a></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/chronicle.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Chronicle Permanode</div><div class="link__sublabel">IOTA permanode</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/identity.rs/introduction"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Identity</div><div class="link__sublabel">Identity framework</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/goshimmer/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">GoShimmer Node</div><div class="link__sublabel">IOTA 2.0 node</div></div></div></a></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/streams/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Streams</div><div class="link__sublabel">Share data securely</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"></div></div></div></div></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog"><div class="link"><div class="link__body"><div class="link__label">Blog</div></div></div></a><a class="navbar__item navbar__link" href="/team"><div class="link"><div class="link__body"><div class="link__label">Team</div></div></div></a><div class="navbar__item navbar__item--dock"><div class="toggle toggle_2xs0 toggle--checked toggle--disabled" role="button" tabindex="-1"><div class="toggle__icon toggle__icon--unchecked" style="font-family:Material Icons">dark_mode</div><div class="toggle__icon toggle__icon--checked" style="font-family:Material Icons">light_mode</div><input type="checkbox" checked="" class="toggle__screenreader-only" aria-label="Switch between dark and light mode"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/img/logo.svg" alt="IOTA Wiki Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo_dark.svg" alt="IOTA Wiki Logo" class="themedImage_1VuW themedImage--dark_hz6m"></a><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/preface">Preface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/1.1Introduction">1.1 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/2.2MessageLayout">2.2 Message Layout</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/2.3StandardPayloadsLayout">2.3 Standard Payloads Layout</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/2.4DataFlow">2.4 Data flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/3.3PeerDiscovery">3.3 Peer Discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/3.4NeighborSelection">3.4 Neighbor Selection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/3.5 Manual Peering">3.5 Manual Peering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/4.1TheTangle">4.1 The Tangle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/4.2Timestamps">4.2 Timestamps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/IOTA-2.0-Research-Specifications/4.3TipSelectionAlgorithm">4.3 Tip Selection Algorithm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/4.4Solidification">4.4 Solidification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/4.5RateControl">4.5 Rate Control through Adaptive Proof of Work</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/4.6CongestionControl">4.6 Congestion control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/4.7Markers">4.7 Markers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/5.1UTXO">5.1 UTXO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/5.2LedgerState">5.2 Ledger State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/5.3Mana">5.3 Mana</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/6.1ObjectsOfConsensus">6.1 Objects of Consensus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/6.2OpinionSetting">6.2 Opinion Setting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/6.3FastProbabilisticConsensus">6.3 Fast Probabilistic Consensus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/6.4Finalization">6.4 Approval Weight and Finality</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/6.5dRNG">6.5 Distributed Random Number Generator</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>4.3 Tip Selection Algorithm</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="431-introduction">4.3.1 Introduction<a class="hash-link" href="#431-introduction" title="Direct link to heading">​</a></h2><p>The tip selection algorithm is the method by which messages are selected for approval by other issued messages joining the network.  This approval mechanism represents “belief” in the Tangle: If message <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span> approves message <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span></span></span></span></span>, this implies that the node issuing <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span> believes that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span></span></span></span></span>, and possibly its past cone, are &quot;good&quot;. </p><p>The tip selection algorithm allows the Tangle to grow in a stable and secure way, with quick approval and finality times. </p><p>We call the new Tip-Section algorithm &quot;R-URTS&quot;, which means &quot;Restricted Uniform Random Tip Selection&quot;. Here we summarize the main differences that the new Tip Selection Algorithm has, compared to the legacy version:</p><ol><li><strong>Uniform Selection:</strong> Unlike the old Random Walk tip selection, we will use a much faster and simpler solution that will select uniformly among a subset of eligible tips. </li><li><strong>Approval Switch Mechanism:</strong> A new mechanism that will allow us to keep a clear Tangle while preventing orphanage from splits due to disliked branches. </li></ol><p>Although we will not be using here, the new message layout (more information in <a href="/IOTA-2.0-Research-Specifications/2.2MessageLayout">Section 2.2 - Message Layout</a>) has the capabilities for a message to have a non-fixed number of messages that it approves (parents), which range from two to eight (see <!-- -->[Section 4.8 - Message Creation 🛠️]<!-- -->). This can be used to develop tip spam protection mechanisms among other purposes. We will denote the number of parents being used in the algorithm by <em>Parental Number</em>. </p><p>The Tip Selection Algorithm specification depends on the following specifications:</p><ul><li><a href="/IOTA-2.0-Research-Specifications/2.2MessageLayout">2.2 - Message Layout</a></li><li><a href="/IOTA-2.0-Research-Specifications/2.4DataFlow">2.4 - Data Flow</a></li><li><a href="/IOTA-2.0-Research-Specifications/4.1TheTangle">4.1 - The Tangle</a></li><li><a href="/IOTA-2.0-Research-Specifications/5.2LedgerState">5.2 - Ledger State</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="432-definitions">4.3.2 Definitions<a class="hash-link" href="#432-definitions" title="Direct link to heading">​</a></h2><p>One of the main improvements of the new Tip Selection Algorithm comes from its ability to keep both a clean non-conflicting subtangle, and to ignore the existence of conflicts in its selection, hence emulating the ability that <a href="https://github.com/iotaledger/protocol-rfcs/blob/master/text/0005-white-flag/0005-white-flag.md" target="_blank" rel="noopener noreferrer">Chrysalis White Flag</a> approach has of being un-splittable. In IOTA 2.0, those properties come from the approval switch mechanism. In the rest of this subsection, we present the theory of the approval switch, which classify approvals and messages in &quot;weak&quot; and &quot;strong&quot;. This information is necessary to define the <em>tip pools</em>, i.e., the sets of (recent) messages which are selectable by the Tip Selection Algorithm (we provide a more complete description of tip pools later in this document).</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="4321-approval-switch">4.3.2.1 Approval switch<a class="hash-link" href="#4321-approval-switch" title="Direct link to heading">​</a></h3><p>In order to properly define and explain the approval switch mechanism, we will need some extra definitions. We also refer to the basic concept of branches (<a href="/IOTA-2.0-Research-Specifications/5.2LedgerState">Section 5.2 - Ledger State</a>) and validity (<a href="/IOTA-2.0-Research-Specifications/4.1TheTangle">Section 4.1 - The Tangle</a>), as they are required to the understanding of some of the definitions below.  </p><ul><li><strong>Tip</strong>: A message is considered a tip (by a node) if it is selectable by the Tip Selection Algorithm, i.e. it is an element of any <em>Tip Pool</em> (of that node). In general, it is perceived as a message that has yet to receive any direct approvers.</li><li><strong>Eligibility</strong>: A Message is said <em>eligible</em> if:<ul><li>It is weakly valid;</li><li>It passes the timestamp check with level of knowledge at least 2;</li><li>All its parents are also eligible messages.</li></ul></li><li><strong>Approval switch</strong>: : A binary field with values <strong>strong</strong> and <strong>weak</strong>  in the message associated with each of its parents, filled by its issuer node. <ul><li><strong>Strong approval</strong>:  Represents that the issuer node declares that the message and its entire past cone are liked. </li><li><strong>Weak approval</strong>:  Represents that the issuer node declares that the message and its payload is liked, but its past cone is not completely liked. </li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="4322-branch">4.3.2.2 Branch<a class="hash-link" href="#4322-branch" title="Direct link to heading">​</a></h3><p>Furthermore, to properly define the tip pool, additional definitions derived by the branch are required. Here we give a summarized definition for the sake of understanding. </p><ul><li><p><strong>Monotonically Liked Branch</strong>: A branch is monotonically liked if all of its transactions are individually liked. </p></li><li><p><strong>Monotonically Liked Message</strong>: A message is monotonically liked if its aggregated branch is monotonically liked.</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="4323-strong-and-weak-messages">4.3.2.3 Strong and weak messages<a class="hash-link" href="#4323-strong-and-weak-messages" title="Direct link to heading">​</a></h3><p>In a heuristic way, one can think of a monotonically liked message as a  message that has a liked payload and that all other payloads that depend on it are also liked.
With this we can classify the messages: </p><ul><li><p><strong>Strong Messages</strong>: We say a message <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span></span></span></span></span> is strong (for a node) if it is:</p><ul><li>Eligible;</li><li>Monotonically liked.</li></ul></li><li><p><strong>Weak Messages</strong>: We say a message <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span></span></span></span></span> is weak (for a node) it is:</p><ul><li>Eligible;</li><li>Contains a liked payload;</li><li>It is not monotonically liked with level of knowledge at least 2. </li></ul></li></ul><p><a target="_blank" href="/assets/files/parents-f5125ab1caf4afd9bb5073281975c5dd.png"><img alt="An example of strong and weak parents" src="/assets/images/parents-f5125ab1caf4afd9bb5073281975c5dd.png" class="fullscreen-image__source"></a></p><p><strong>Image 4.3.1:</strong> An example of strong and weak parents. Observe that although B is in the past cone of I, it is not in its strong past cone. </p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="433-tip-pools">4.3.3 Tip Pools<a class="hash-link" href="#433-tip-pools" title="Direct link to heading">​</a></h2><p>The tip is a product of the construction of the Tip Pools, and in general it represents messages that are yet to be directly approved by other messages. The tip pools are built by filtering the messages that arrive from the neighbors, checking which ones are proper to be selectable by the algorithm. In this subsection we will define such filters and classifications that are used to make the Tip Pools. </p><p>Differently from the legacy implementation, we will not have a single pool, but instead two, divided according to the new concept of the <em>Approval Switch</em> mechanism. </p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="4331-construction-of-the-tip-pools">4.3.3.1 Construction of the Tip Pools<a class="hash-link" href="#4331-construction-of-the-tip-pools" title="Direct link to heading">​</a></h3><p>We will define a sequence of pools, each one selected by filtering the previous one regarding one condition, until we conclude with the two elements used in the Tip Selection Algorithm: the <em>Strong Tips Pool</em> and the <em>Weak Tip Pool</em>. </p><ol><li><p><strong>Eligible Messages Pool:</strong> This pool consists of all messages that were also approved by the <em>Eligibility Check</em> (see <a href="/IOTA-2.0-Research-Specifications/2.4Dataflow">Section 2.4 - Data Flow</a>).</p></li><li><p><strong>Liked Payload Pool:</strong> This pool consists of all eligible messages that contain a payload tagged as &quot;liked&quot;, i.e. is either data or an individually liked transaction. </p></li><li><p><strong>Strong Tips Pool</strong>: This pool consists of all strong messages in the <em>Liked Payload Pool</em>.</p></li><li><p><strong>Weak Tips Pool</strong>: This pool consists of all messages from the <em>Liked Payload Pool</em> that were not included in the <em>Strong Tips Pool</em>. </p></li></ol><p>The two main pools to be used by the tip selection algorithm are the <em>Strong Tips Pool</em> and the <em>Weak Tips Pool</em>. Observe that from our definition, each pool in the list is always constructed by performing a filtering in the previous one, but how this filtering will be performed is considered an implementation detail and hence will not be further considered here. </p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="4332-update-of-the-tip-pools">4.3.3.2 Update of the tip pools<a class="hash-link" href="#4332-update-of-the-tip-pools" title="Direct link to heading">​</a></h3><p>There are two types of updates that can be done with the strong and weak tip pools:</p><ol><li><strong>Removal</strong>: Tips are removed when they are approved by other messages. This can happen in two ways:<ul><li>When the node issues a message, the selected tips will be removed from the respective tip pools after the Tip Selection Algorithm is performed (we briefly explain the procedure in the <a href="#434-R-URTS">R-URTS</a> subsection, further information may be found in the <!-- -->[Section 4.8 - Message Creation 🛠️]<!-- -->).</li><li>When a new message is received, its parents shall be removed from the respective tip pools by the <em>Tip Manager</em> application (further information may be found in the <a href="/IOTA-2.0-Research-Specifications/2.4Dataflow">Section 2.4 - Data Flow</a>).</li></ul></li><li><strong>Rearrangement:</strong> Tips can be changed from the strong tip pool to the weak tip pool, or from the weak tip pool to the strong tip pool if the perception of the branches they belong to changes, this is explained in more details in Section 6.5 - Node Perception Reorganization.</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="434-r-urts">4.3.4 R-URTS<a class="hash-link" href="#434-r-urts" title="Direct link to heading">​</a></h2><p>We want to reiterate here that, ultimately, the tip selection is a free procedure not enforced by the protocol. Therefore, each node may, if it sees worth, to select its approvees in a manual way or following another algorithm of its preference. What we will present here is the standard algorithm, that works both as a suggestion but also as something that the nodes will have implemented and will use by default. </p><p>The suggested standard tip selection algorithm is R-URTS (Restricted Uniform Random Tip Selection), which selects messages with uniform probability among the list of tips restricted by some condition.  </p><p>Let us give an example for a Tip Selection Algorithm with Parental Number <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span>:</p><ol><li>Consider the <em>Strong Tips Pool</em> and the <em>Weak Tip Pools</em> updated. </li><li>The node shall select the first tip from the <em>Strong Tips Pool</em>.</li><li>The node shall select tips from numbered <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">2</span></span></span></span></span> to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> from the union of the <em>Strong Tips Pool</em> and the <em>Weak Tips Pool</em>.</li><li>The node shall register in the message&#x27;s <code>Parents type</code> field if each selected parent was from the strong or weak tip pools.</li><li>The node shall remove the selected tips from their respective pools. </li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/edit/docusaurus/docs/4.3TipSelectionAlgorithm.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/IOTA-2.0-Research-Specifications/4.2Timestamps"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">4.2 Timestamps</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/IOTA-2.0-Research-Specifications/4.4Solidification"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">4.4 Solidification</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#431-introduction" class="table-of-contents__link toc-highlight">4.3.1 Introduction</a></li><li><a href="#432-definitions" class="table-of-contents__link toc-highlight">4.3.2 Definitions</a><ul><li><a href="#4321-approval-switch" class="table-of-contents__link toc-highlight">4.3.2.1 Approval switch</a></li><li><a href="#4322-branch" class="table-of-contents__link toc-highlight">4.3.2.2 Branch</a></li><li><a href="#4323-strong-and-weak-messages" class="table-of-contents__link toc-highlight">4.3.2.3 Strong and weak messages</a></li></ul></li><li><a href="#433-tip-pools" class="table-of-contents__link toc-highlight">4.3.3 Tip Pools</a><ul><li><a href="#4331-construction-of-the-tip-pools" class="table-of-contents__link toc-highlight">4.3.3.1 Construction of the Tip Pools</a></li><li><a href="#4332-update-of-the-tip-pools" class="table-of-contents__link toc-highlight">4.3.3.2 Update of the tip pools</a></li></ul></li><li><a href="#434-r-urts" class="table-of-contents__link toc-highlight">4.3.4 R-URTS</a></li></ul></div></div></div></div></main></div></div><footer class="footer padding--none"><div class="container"><div class="row footer__links padding-vert--xl"><div class="col footer__col"><h4 class="footer__title">LEARN</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/learn/about-iota/an-introduction-to-iota">About IOTA</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/iota-token/buying-iota">IOTA Token</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/wallets/what-is-a-wallet">Wallets</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/networks/iota-1.5-chrysalis">Networks</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/resource-materials/glossary">Resource Materials</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/research/research-outline">Research</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/future/future-of-iota">Future of IOTA</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">PARTICIPATE</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/participate/support-the-network/about-nodes">Support the network</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/the-community/discord">The Community</a></li><li class="footer__item"><a href="https://www.iota.org/solutions/partnerships" target="_blank" rel="noopener noreferrer" class="footer__link-item">Partnerships</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/funding/edf-funding">Funding</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/use-cases/industry-applications">Use Cases</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/frameworks/introduction">Frameworks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">BUILD</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/build/welcome">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/build/fundamentals/cryptography">Fundamentals</a></li><li class="footer__item"><a class="footer__link-item" href="/build/exchange-integration/exchange-integration-guide">Exchange Integration</a></li><li class="footer__item"><a class="footer__link-item" href="/build/tutorials/twitch">Tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">WIKI</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/team">Team</a></li><li class="footer__item"><a href="https://github.com/iota-community/iota-wiki" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://github.com/jlvandenhout/docusaurus-plugin-docs-editor" target="_blank" rel="noopener noreferrer" class="footer__link-item">Editor Github</a></li><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/contribute-to-wiki/welcome">Contribute</a></li></ul></div></div><div class="footer__bottom padding-bottom--xl"><div><a href="https://www.iota.org" target="_blank" rel="noopener noreferrer"><img src="/img/iota_logo.svg" alt="IOTA Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/iota_logo.svg" alt="IOTA Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">© 2021 IOTA Wiki. Built with Docusaurus.</div></div></div><div class="social"><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:var(--ifm-color-gray-900)" href="https://www.youtube.com/c/iotafoundation"><div class="social__font social__icon"></div><div class="social__title">Youtube</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#2C3850" href="https://www.github.com/iotaledger/"><div class="social__font social__icon"></div><div class="social__title">GitHub</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#4B576F" href="https://discord.iota.org/"><div class="social__font social__icon"></div><div class="social__title">Discord</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#6A768E" href="https://www.twitter.com/iota/"><div class="social__font social__icon"></div><div class="social__title">Twitter</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#7D89A1" href="https://www.reddit.com/r/iota/"><div class="social__font social__icon"></div><div class="social__title">Reddit</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#8995AD" href="https://www.linkedin.com/company/iotafoundation/"><div class="social__font social__icon"></div><div class="social__title">LinkedIn</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#99A5BD" href="https://www.instagram.com/iotafoundation/"><div class="social__font social__icon"></div><div class="social__title">Instagram</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#BAC6DE" href="https://www.facebook.com/TheIOTAFoundation/"><div class="social__font social__icon"></div><div class="social__title">Facebook</div></a></div></footer></div>
<script src="/assets/js/runtime~main.fb93c638.js"></script>
<script src="/assets/js/main.bf5c9b22.js"></script>
</body>
</html>