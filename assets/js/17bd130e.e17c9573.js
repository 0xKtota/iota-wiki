"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[42215],{545:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return u},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return h}});var a=n(87462),o=n(63366),i=(n(67294),n(3905)),r=["components"],l={description:"The `governance` contract defines the set of identities that constitute the state controller, access nodes, who is the chain owner and the fees for request execution.",image:"/img/logo/WASP_logo_dark.png",keywords:["core contracts","governance","state controller","identities","chain owner","rotate","remove","claim","add","chain info","fee info","reference"]},c="The `governance` Contract",s={unversionedId:"guide/core_concepts/core_contracts/governance",id:"guide/core_concepts/core_contracts/governance",title:"The `governance` Contract",description:"The `governance` contract defines the set of identities that constitute the state controller, access nodes, who is the chain owner and the fees for request execution.",source:"@site/content/build/wasp/develop/documentation/docs/guide/core_concepts/core_contracts/governance.md",sourceDirName:"guide/core_concepts/core_contracts",slug:"/guide/core_concepts/core_contracts/governance",permalink:"/smart-contracts/guide/core_concepts/core_contracts/governance",draft:!1,editUrl:"https://github.com/iotaledger/wasp/edit/develop/documentation/content/build/wasp/develop/documentation/docs/guide/core_concepts/core_contracts/governance.md",tags:[],version:"current",frontMatter:{description:"The `governance` contract defines the set of identities that constitute the state controller, access nodes, who is the chain owner and the fees for request execution.",image:"/img/logo/WASP_logo_dark.png",keywords:["core contracts","governance","state controller","identities","chain owner","rotate","remove","claim","add","chain info","fee info","reference"]},sidebar:"tutorialSidebar",previous:{title:"The `blocklog` Contract",permalink:"/smart-contracts/guide/core_concepts/core_contracts/blocklog"},next:{title:"The `errors` Contract",permalink:"/smart-contracts/guide/core_concepts/core_contracts/errors"}},d={},h=[{value:"Entry Points",id:"entry-points",level:2},{value:"<code>rotateStateController(S StateControllerAddress)</code>",id:"rotatestatecontrollers-statecontrolleraddress",level:3},{value:"<code>addAllowedStateControllerAddress(S StateControllerAddress)</code>",id:"addallowedstatecontrolleraddresss-statecontrolleraddress",level:3},{value:"<code>removeAllowedStateControllerAddress(S StateControllerAddress)</code>",id:"removeallowedstatecontrolleraddresss-statecontrolleraddress",level:3},{value:"<code>delegateChainOwnership(o AgentID)</code>",id:"delegatechainownershipo-agentid",level:3},{value:"<code>claimChainOwnership()</code>",id:"claimchainownership",level:3},{value:"<code>setChainInfo(mb MaxBlobSize, me MaxEventSize, mr MaxEventsPerRequest)</code>",id:"setchaininfomb-maxblobsize-me-maxeventsize-mr-maxeventsperrequest",level:3},{value:"<code>setFeePolicy(g FeePolicy)</code>",id:"setfeepolicyg-feepolicy",level:3},{value:"<code>addCandidateNode(ip PubKey, ic Certificate, ia API, i ForCommittee)</code>",id:"addcandidatenodeip-pubkey-ic-certificate-ia-api-i-forcommittee",level:3},{value:"<code>revokeAccessNode(ip PubKey, ic Certificate, ia API, i ForCommittee)</code>",id:"revokeaccessnodeip-pubkey-ic-certificate-ia-api-i-forcommittee",level:3},{value:"<code>changeAccessNodes(n actions)</code>",id:"changeaccessnodesn-actions",level:3},{value:"<code>startMaintenance()</code>",id:"startmaintenance",level:3},{value:"<code>stopMaintenance()</code>",id:"stopmaintenance",level:3},{value:"Views",id:"views",level:2},{value:"<code>getAllowedStateControllerAddresses()</code>",id:"getallowedstatecontrolleraddresses",level:3},{value:"<code>getChainOwner()</code>",id:"getchainowner",level:3},{value:"<code>getChainInfo()</code>",id:"getchaininfo",level:3},{value:"<code>getFeePolicy()</code>",id:"getfeepolicy",level:3},{value:"<code>getChainNodes()</code>",id:"getchainnodes",level:3},{value:"<code>getMaintenanceStatus()</code>",id:"getmaintenancestatus",level:3}],p={toc:h};function u(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"the-governance-contract"},"The ",(0,i.kt)("inlineCode",{parentName:"h1"},"governance")," Contract"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"governance")," contract is one of the ",(0,i.kt)("a",{parentName:"p",href:"/smart-contracts/overview"},"core contracts")," on each IOTA Smart Contracts\nchain."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"governance")," contract provides the following functionalities:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"It defines the set of identities that constitute the state controller (entity that owns the state output via the chain Alias Address). It is possible to add/remove addresses from the stateController (thus rotating the committee of validators)."),(0,i.kt)("li",{parentName:"ul"},"It defines who is the chain owner (the L1 entity that owns the chain - initially whoever deployed it). The chain owner can collect special fees, and customize some chain-specific parameters."),(0,i.kt)("li",{parentName:"ul"},"It defines who are the entities allowed to have an access node."),(0,i.kt)("li",{parentName:"ul"},"It defines the fee policy for the chain (gas price, what token in used to pay for gas, and the validator fee share).")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"entry-points"},"Entry Points"),(0,i.kt)("p",null,"The following are the functions/entry points of the ",(0,i.kt)("inlineCode",{parentName:"p"},"governance")," contract. Most governance entry points can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"rotatestatecontrollers-statecontrolleraddress"},(0,i.kt)("inlineCode",{parentName:"h3"},"rotateStateController(S StateControllerAddress)")),(0,i.kt)("p",null,"Called when committee is about to be rotated to the new address ",(0,i.kt)("inlineCode",{parentName:"p"},"S"),". If it fails, nothing happens. If it succeeds, the next state transition will become a governance transition, thus updating the state controller in the chain's AliasOutput."),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"addallowedstatecontrolleraddresss-statecontrolleraddress"},(0,i.kt)("inlineCode",{parentName:"h3"},"addAllowedStateControllerAddress(S StateControllerAddress)")),(0,i.kt)("p",null,"Adds the address ",(0,i.kt)("inlineCode",{parentName:"p"},"S")," to the list of identities that constitute the state controller, this change will only become effective once ",(0,i.kt)("inlineCode",{parentName:"p"},"rotateStateController")," is called."),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"removeallowedstatecontrolleraddresss-statecontrolleraddress"},(0,i.kt)("inlineCode",{parentName:"h3"},"removeAllowedStateControllerAddress(S StateControllerAddress)")),(0,i.kt)("p",null,"Removes the address ",(0,i.kt)("inlineCode",{parentName:"p"},"S")," from the list of identities that constitute the state controller, this change will only become effective once ",(0,i.kt)("inlineCode",{parentName:"p"},"rotateStateController")," is called."),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"delegatechainownershipo-agentid"},(0,i.kt)("inlineCode",{parentName:"h3"},"delegateChainOwnership(o AgentID)")),(0,i.kt)("p",null,"Sets the AgentID ",(0,i.kt)("inlineCode",{parentName:"p"},"o")," as the new owner for the chain. This change will only be effective once ",(0,i.kt)("inlineCode",{parentName:"p"},"claimChainOwnership")," is called by ",(0,i.kt)("inlineCode",{parentName:"p"},"o"),"."),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"claimchainownership"},(0,i.kt)("inlineCode",{parentName:"h3"},"claimChainOwnership()")),(0,i.kt)("p",null,"Claims the ownership of the chain if the caller matches the identity set in ",(0,i.kt)("inlineCode",{parentName:"p"},"delegateChainOwnership"),"."),(0,i.kt)("h3",{id:"setchaininfomb-maxblobsize-me-maxeventsize-mr-maxeventsperrequest"},(0,i.kt)("inlineCode",{parentName:"h3"},"setChainInfo(mb MaxBlobSize, me MaxEventSize, mr MaxEventsPerRequest)")),(0,i.kt)("p",null,"Allows the following chain parameters to be set by the chain owner: ",(0,i.kt)("inlineCode",{parentName:"p"},"MaxBlobSize"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"MaxEventSize"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"MaxEventsPerRequest"),"."),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"setfeepolicyg-feepolicy"},(0,i.kt)("inlineCode",{parentName:"h3"},"setFeePolicy(g FeePolicy)")),(0,i.kt)("p",null,"Sets the fee policy for the chain. This includes the Token ID to be used for gas (by default is ",(0,i.kt)("inlineCode",{parentName:"p"},"null")," for the base token), the GasPerToken (how many units of gas a token pays for), and the  ValidatorFee which is a value of 0-100, that means how much of the gas fees are distributed to the validators."),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"addcandidatenodeip-pubkey-ic-certificate-ia-api-i-forcommittee"},(0,i.kt)("inlineCode",{parentName:"h3"},"addCandidateNode(ip PubKey, ic Certificate, ia API, i ForCommittee)")),(0,i.kt)("p",null,"Adds a node to the list of candidates.\nThe required parameters are the following:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ip")," The public key of the node to be added"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ic")," The Certficate is a signed binary containing both the node public key, and their L1 address."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ia")," The API url for the node"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"i")," boolean (default false) - whether the candidate node is being added to be part of the committee, or just an access node")),(0,i.kt)("p",null,"Can only be invoked by the access node owner (verified via the Certificate field)."),(0,i.kt)("h3",{id:"revokeaccessnodeip-pubkey-ic-certificate-ia-api-i-forcommittee"},(0,i.kt)("inlineCode",{parentName:"h3"},"revokeAccessNode(ip PubKey, ic Certificate, ia API, i ForCommittee)")),(0,i.kt)("p",null,"Removes a node from the list of candidates.\nThe parameters needed are the same as ",(0,i.kt)("inlineCode",{parentName:"p"},"addCandidateNode")),(0,i.kt)("p",null,"Can only be invoked by the access node owner (verified via the Certificate field)."),(0,i.kt)("h3",{id:"changeaccessnodesn-actions"},(0,i.kt)("inlineCode",{parentName:"h3"},"changeAccessNodes(n actions)")),(0,i.kt)("p",null,"Iterates through a map of actions (",(0,i.kt)("inlineCode",{parentName:"p"},"n"),") and applies those actions. These actions are a map of pubKey -> to a byte value, this byte value can mean different things:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"0 - Removes an access node from the access nodes list"),(0,i.kt)("li",{parentName:"ul"},"1 - Accept a candidate node and adds it to the list of access nodes"),(0,i.kt)("li",{parentName:"ul"},"2 - Drops an access node from the access nodes list and candidates list")),(0,i.kt)("p",null,"Can only be invoked by the chain owner."),(0,i.kt)("h3",{id:"startmaintenance"},(0,i.kt)("inlineCode",{parentName:"h3"},"startMaintenance()")),(0,i.kt)("p",null,"Starts the maintenance mode.\nCan only be invoked by the chain owner."),(0,i.kt)("h3",{id:"stopmaintenance"},(0,i.kt)("inlineCode",{parentName:"h3"},"stopMaintenance()")),(0,i.kt)("p",null,"Stops the maintenance mode.\nCan only be invoked by the chain owner."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"views"},"Views"),(0,i.kt)("p",null,"Can be called directly. Calling a view does not modify the state of the smart contract."),(0,i.kt)("h3",{id:"getallowedstatecontrolleraddresses"},(0,i.kt)("inlineCode",{parentName:"h3"},"getAllowedStateControllerAddresses()")),(0,i.kt)("p",null,"Returns the list of allowed state controllers."),(0,i.kt)("h3",{id:"getchainowner"},(0,i.kt)("inlineCode",{parentName:"h3"},"getChainOwner()")),(0,i.kt)("p",null,"Returns the AgentID of the chain owner."),(0,i.kt)("h3",{id:"getchaininfo"},(0,i.kt)("inlineCode",{parentName:"h3"},"getChainInfo()")),(0,i.kt)("p",null,"Returns the following chain parameters: ",(0,i.kt)("inlineCode",{parentName:"p"},"MaxBlobSize"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"MaxEventSize"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"MaxEventsPerRequest"),"."),(0,i.kt)("h3",{id:"getfeepolicy"},(0,i.kt)("inlineCode",{parentName:"h3"},"getFeePolicy()")),(0,i.kt)("p",null,"Returns the fee policy for the chain (gas price, what token in used to pay for gas, and the validator fee share)."),(0,i.kt)("h3",{id:"getchainnodes"},(0,i.kt)("inlineCode",{parentName:"h3"},"getChainNodes()")),(0,i.kt)("p",null,"Returns a list of the current AccessNodes, and another list with the current candidates."),(0,i.kt)("h3",{id:"getmaintenancestatus"},(0,i.kt)("inlineCode",{parentName:"h3"},"getMaintenanceStatus()")),(0,i.kt)("p",null,"Returns whether the chain is ongoing maintenance."))}u.isMDXComponent=!0},3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return u}});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=s(n),u=o,m=p["".concat(c,".").concat(u)]||p[u]||h[u]||i;return n?a.createElement(m,r(r({ref:t},d),{},{components:n})):a.createElement(m,r({ref:t},d))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var s=2;s<i;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);