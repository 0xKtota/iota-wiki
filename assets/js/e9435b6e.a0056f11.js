"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[775],{89740:(e,t,n)=>{n.d(t,{ZP:()=>l});var a=n(87462),o=(n(67294),n(3905));const s={toc:[]};function l(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("admonition",{title:"Guide Coming Soon",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"This how to guide is not available in your language of choice at the moment.\nPlease feel free to browse ",(0,o.kt)("a",{parentName:"p",href:"/wallet.rs/develop/how_tos/more_examples"},"more examples")," which may suit your requirements.")))}l.isMDXComponent=!0},24149:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>b,default:()=>y,frontMatter:()=>m,metadata:()=>f,toc:()=>k});var a=n(87462),o=(n(67294),n(3905)),s=n(54411),l=n(43305),u=n(44393);const d={toc:[]};function i(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)(u.Z,{className:"language-javascript",mdxType:"CodeBlock"},"/**\n * This example sends IOTA tokens with an expiration date and claims them.\n */\n\nconst getUnlockedManager = require('./account-manager');\n\nlet manager\nlet bob\n\nasync function run() {\n    try {\n        manager = await getUnlockedManager();\n        const alice = await manager.getAccount('Alice');\n        bob = await manager.getAccount('Bob');\n\n        manager.listen(['NewOutput'], handleNewOutputOfBob)\n\n        const recipientAddress = bob.meta.publicAddresses[0].address\n        const amount = '1000000';\n\n        const outputData = await alice.prepareOutput(\n            {\n                recipientAddress,\n                amount,\n                unlocks: {\n                    expiration: {\n                        unixTime: Math.round(new Date().getTime() / 1000) + 15000\n                    }\n                }\n            },\n        );\n\n        const resp = await alice.sendOutputs([outputData])\n        console.log('Transaction is sent', resp)\n\n        // Sync account to get the output event\n        setTimeout(async () => {\n            await bob.sync();\n        }, 10000)\n    } catch (error) {\n        console.log('Error: ', error);\n    }\n}\n\nasync function handleNewOutputOfBob(err, data) {\n    console.log('Output received:', data)\n    const event = JSON.parse(data)\n    if (event.accountIndex === bob.meta.index) {\n        const outputId = event.event.NewOutput.output.outputId\n        await bob.sync()\n        const resp = await bob.claimOutputs([outputId])\n        console.log('Output has been claimed in the following transaction:', resp)\n        process.exit(0)\n    }\n}\nrun();\n"),(0,o.kt)("p",null,"You can run the example by running the following command from the ",(0,o.kt)("inlineCode",{parentName:"p"},"bindings/node/examples/")," folder:"),(0,o.kt)(u.Z,{className:"language-bash",mdxType:"CodeBlock"},"node 21-claim-outputs.js"))}i.isMDXComponent=!0;const r={toc:[]};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},r,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'Transaction is sent {\n  payload: {\n    type: 6,\n    essence: {\n      type: 1,\n      networkId: \'8342982141227064571\',\n      inputs: [Array],\n      inputsCommitment: \'0xe564a6ec7749b3c09e06b05c76c95b37a34d0fd026dfb4082b8e4ff900f9dc81\',\n      outputs: [Array]\n    },\n    unlocks: [ [Object] ]\n  },\n  blockId: \'0x8ce286630d376d3f6f2c74c1f758e38a0b88d776887aa6e4c7af0c125b533c7f\',\n  inclusionState: \'Pending\',\n  timestamp: \'1663005430349\',\n  transactionId: \'0xad3f8e00af9d56d22eff5ec730e01918e52d80c87e94859e00907099091aa95a\',\n  networkId: \'8342982141227064571\',\n  incoming: false,\n  note: null\n}\nOutput received: {"accountIndex":0,"event":{"NewOutput":{"output":{"outputId":"0xad3f8e00af9d56d22eff5ec730e01918e52d80c87e94859e00907099091aa95a0100","metadata":{"blockId":"0x8ce286630d376d3f6f2c74c1f758e38a0b88d776887aa6e4c7af0c125b533c7f","transactionId":"0xad3f8e00af9d56d22eff5ec730e01918e52d80c87e94859e00907099091aa95a","outputIndex":1,"isSpent":false,"milestoneIndexBooked":974130,"milestoneTimestampBooked":1663005433,"ledgerIndex":974130},"output":{"type":3,"amount":"998837200","unlockConditions":[{"type":0,"address":{"type":0,"pubKeyHash":"0xeed1e4e3e9e7555e2f1592594bf916523e7fef3a9a8c0d630a4934440b822647"}}]},"isSpent":false,"address":{"type":0,"pubKeyHash":"0xeed1e4e3e9e7555e2f1592594bf916523e7fef3a9a8c0d630a4934440b822647"},"networkId":"8342982141227064571","remainder":true,"chain":[{"hardened":true,"bs":[128,0,0,44]},{"hardened":true,"bs":[128,0,16,123]},{"hardened":true,"bs":[128,0,0,0]},{"hardened":true,"bs":[128,0,0,0]},{"hardened":true,"bs":[128,0,0,0]}]},"transaction":null,"transactionInputs":null}}}\nOutput received: {"accountIndex":1,"event":{"NewOutput":{"output":{"outputId":"0xad3f8e00af9d56d22eff5ec730e01918e52d80c87e94859e00907099091aa95a0000","metadata":{"blockId":"0x8ce286630d376d3f6f2c74c1f758e38a0b88d776887aa6e4c7af0c125b533c7f","transactionId":"0xad3f8e00af9d56d22eff5ec730e01918e52d80c87e94859e00907099091aa95a","outputIndex":0,"isSpent":false,"milestoneIndexBooked":974130,"milestoneTimestampBooked":1663005433,"ledgerIndex":974131},"output":{"type":3,"amount":"1000000","unlockConditions":[{"type":0,"address":{"type":0,"pubKeyHash":"0x085748b21812b9fd706d58983a7b16dabe8a068bd8473ee1cd322fc9e02d8703"}}]},"isSpent":false,"address":{"type":0,"pubKeyHash":"0x085748b21812b9fd706d58983a7b16dabe8a068bd8473ee1cd322fc9e02d8703"},"networkId":"8342982141227064571","remainder":false,"chain":[{"hardened":true,"bs":[128,0,0,44]},{"hardened":true,"bs":[128,0,16,123]},{"hardened":true,"bs":[128,0,0,1]},{"hardened":true,"bs":[128,0,0,0]},{"hardened":true,"bs":[128,0,0,0]}]},"transaction":null,"transactionInputs":null}}}\nOutput has been claimed in the following transaction: [\n  {\n    payload: { type: 6, essence: [Object], unlocks: [Array] },\n    blockId: \'0x3881d8a790b70d6cd3d5b7e4ade65f20cc2a1a9c88af76d612b3646fdd471d7a\',\n    inclusionState: \'Pending\',\n    timestamp: \'1663005447689\',\n    transactionId: \'0x046a1112ba53beeee146dd4b0a28c59565fda3f62628b53655b5719b326e25d0\',\n    networkId: \'8342982141227064571\',\n    incoming: false,\n    note: null\n  }\n]\n\n')))}c.isMDXComponent=!0;var p=n(89740);const m={title:"Claim Outputs",description:"How to send and claim funds with a time-lock using wallet.rs.",image:"/img/logo/iota_mark_light.png",keywords:["how to","time-lock","unlock conditions","claim output","send output","nodejs","python","rust"]},b=void 0,f={unversionedId:"how_tos/outputs_and_transactions/claim_outputs",id:"how_tos/outputs_and_transactions/claim_outputs",title:"Claim Outputs",description:"How to send and claim funds with a time-lock using wallet.rs.",source:"@site/content/build/wallet.rs/develop/documentation/docs/how_tos/outputs_and_transactions/04_claim_outputs.mdx",sourceDirName:"how_tos/outputs_and_transactions",slug:"/how_tos/outputs_and_transactions/claim_outputs",permalink:"/wallet.rs/develop/how_tos/outputs_and_transactions/claim_outputs",draft:!1,editUrl:"https://github.com/iotaledger/wallet.rs/edit/develop/documentation/content/build/wallet.rs/develop/documentation/docs/how_tos/outputs_and_transactions/04_claim_outputs.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Claim Outputs",description:"How to send and claim funds with a time-lock using wallet.rs.",image:"/img/logo/iota_mark_light.png",keywords:["how to","time-lock","unlock conditions","claim output","send output","nodejs","python","rust"]},sidebar:"docs",previous:{title:"List Outputs",permalink:"/wallet.rs/develop/how_tos/outputs_and_transactions/list_outputs"},next:{title:"List Transactions",permalink:"/wallet.rs/develop/how_tos/outputs_and_transactions/list_transactions"}},h={},k=[{value:"Code Example",id:"code-example",level:2},{value:"Expected Output",id:"expected-output",level:2}],w={toc:k};function y(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},w,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"You can use wallet.rs to send\n",(0,o.kt)("a",{parentName:"p",href:"https://wiki.iota.org/introduction/develop/explanations/ledger/simple_transfers#transfer-of-funds-with-expiration"},"funds with an expiration"),".\nIf you don't claim these funds within the expiration period, they will be returned to the sender."),(0,o.kt)("h2",{id:"code-example"},"Code Example"),(0,o.kt)("p",null,"The following example will:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create an account manager."),(0,o.kt)("li",{parentName:"ol"},"Get Alice's and Bob's account which were ",(0,o.kt)("a",{parentName:"li",href:"/wallet.rs/develop/how_tos/accounts_and_addresses/create_a_wallet_account"},"created in the first guide"),"."),(0,o.kt)("li",{parentName:"ol"},"Prepare and send an output with an expiration unlock."),(0,o.kt)("li",{parentName:"ol"},"Sync Bob's account to get the output event."),(0,o.kt)("li",{parentName:"ol"},"Claim the output by calling the ",(0,o.kt)("inlineCode",{parentName:"li"},"account.claimOutputs([outputId])")," function from Bob's account.")),(0,o.kt)(s.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"rust",label:"Rust",mdxType:"TabItem"},(0,o.kt)(p.ZP,{mdxType:"RustCode"})),(0,o.kt)(l.Z,{value:"nodejs",label:"Nodejs",mdxType:"TabItem"},(0,o.kt)(i,{mdxType:"NodejsCode"})),(0,o.kt)(l.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,o.kt)(p.ZP,{mdxType:"PythonCode"}))),(0,o.kt)("h2",{id:"expected-output"},"Expected Output"),(0,o.kt)(s.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"rust",label:"Rust",mdxType:"TabItem"},(0,o.kt)(p.ZP,{mdxType:"RustOutput"})),(0,o.kt)(l.Z,{value:"nodejs",label:"Nodejs",mdxType:"TabItem"},(0,o.kt)(c,{mdxType:"NodejsOutput"})),(0,o.kt)(l.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,o.kt)(p.ZP,{mdxType:"PythonOutput"}))))}y.isMDXComponent=!0},43305:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(67294),o=n(86010);const s="tabItem__kUE";function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(s,l),hidden:n},t)}},54411:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(87462),o=n(67294),s=n(86010),l=n(51048),u=n(33609),d=n(1943),i=n(72957);const r="tabList_fbd4",c="tabItem_v5XY";function p(e){var t,n;const{lazy:l,block:p,defaultValue:m,values:b,groupId:f,className:h}=e,k=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),w=null!=b?b:k.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),y=(0,u.l)(w,((e,t)=>e.value===t.value));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.');const g=null===m?m:null!=(t=null!=m?m:null==(n=k.find((e=>e.props.default)))?void 0:n.props.value)?t:k[0].props.value;if(null!==g&&!w.some((e=>e.value===g)))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+g+'" but none of its children has the corresponding value. Available values are: '+w.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");const{tabGroupChoices:v,setTabGroupChoices:x}=(0,d.U)(),[_,T]=(0,o.useState)(g),I=[],{blockElementScrollPositionUntilNextRender:N}=(0,i.o5)();if(null!=f){const e=v[f];null!=e&&e!==_&&w.some((t=>t.value===e))&&T(e)}const O=e=>{const t=e.currentTarget,n=I.indexOf(t),a=w[n].value;a!==_&&(N(t),T(a),null!=f&&x(f,String(a)))},C=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{var a;const t=I.indexOf(e.currentTarget)+1;n=null!=(a=I[t])?a:I[0];break}case"ArrowLeft":{var o;const t=I.indexOf(e.currentTarget)-1;n=null!=(o=I[t])?o:I[I.length-1];break}}null==(t=n)||t.focus()};return o.createElement("div",{className:(0,s.Z)("tabs-container",r)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":p},h)},w.map((e=>{let{value:t,label:n,attributes:l}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:_===t?0:-1,"aria-selected":_===t,key:t,ref:e=>I.push(e),onKeyDown:C,onFocus:O,onClick:O},l,{className:(0,s.Z)("tabs__item",c,null==l?void 0:l.className,{"tabs__item--active":_===t})}),null!=n?n:t)}))),l?(0,o.cloneElement)(k.filter((e=>e.props.value===_))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},k.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==_})))))}function m(e){const t=(0,l.Z)();return o.createElement(p,(0,a.Z)({key:String(t)},e))}}}]);